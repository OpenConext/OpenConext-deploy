---
- name: Create directory to keep configfile
  file:
    dest: "/opt/{{ env }}/spdashboard"
    state: directory
    owner: root
    group: root
    mode: 0770

- name: Place the configfile
  template:
    src: "{{ item }}.j2"
    dest: "/opt/{{ env }}/spdashboard/{{ item }}"
    owner: root
    group: root
    mode: 0644
  with_items: 
    - parameters.yml
    - 000-default.conf

- name: Include docker swarm based SPdashboard installation
  include_tasks: dockerswarm.yml
  when: "'docker_swarm_apps' in group_names"

- name: Include docker based Haproxy installation
  include_tasks: docker.yml
  when: "'docker_swarm_apps' not in group_names"
