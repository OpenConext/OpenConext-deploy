- name: Create the spdashboard container network
  docker_network:
    name: "spdashboard"

- name: Create the web container
  docker_container:
    name: spdashboard_web
    image: ghcr.io/surfnet/sp-dashboard/spdashboard_web:{{ spd_docker_web_version }}
    published_ports: 0.0.0.0:80:80
    pull: true
    restart_policy: "always"
    networks:
      - name: "spdashboard"
 
- name: Create the php-fpm container
  docker_container:
    name: spdashboard_php-fpm
    image: ghcr.io/surfnet/sp-dashboard/spdashboard_php-fpm:{{ spd_docker_phpfpm_version }}
    pull: true
    restart_policy: "always"
    env:
      SYMFONY_ENV: "prod"
    mounts:
      - source: /opt/openconext/spdashboard/parameters.yml
        target: /var/www/html/app/config/parameters.yml
        type: bind
      - source: /dev/log
        target: /dev/log
        type: bind
    networks:
      - name: "spdashboard"
