- name: Install REMI repo for Enterprise Linux 7
  yum: name=http://rpms.famillecollet.com/enterprise/remi-release-7.rpm state=present

- name: Enable REMI repo for Enterprise Linux 7
  copy: src=remi.repo dest=/etc/yum.repos.d/remi.repo

- name: Install PHP
  yum: name=php state=present enablerepo=remi

- name: Install PHP extensions
  yum: name={{ item }} state=present enablerepo=remi
  with_items:
        - php-cli
        - php-bcmath
        - php-mbstring
        - php-mcrypt
        - php-pdo
        - php-mysql
        - php-gmp
        - php-xml

- name: Configure PHP
  template:
    dest: /etc/php.ini
    src: php.ini.j2

- name: Configure PHP APC
  template: src={{ item }}.j2 dest=/etc/php.d/{{ item }}
  with_items:
    - apc.ini
    - openconext.ini

- name: Enable php in apache
  copy: src=httpd.php.conf dest=/etc/httpd/conf.d/php.conf
  notify: reload httpd
